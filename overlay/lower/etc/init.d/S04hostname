#!/bin/sh

. /etc/init.d/rc.common

case "$1" in
	start)
		HOSTNAME=$(envvar hostname)
		if [ -z "$HOSTNAME" ]; then
			OS_NAME=$(sed -n 's/^HOSTNAME=//p' /etc/os-release)
			MAC_SUFFIX=$(envvar wlanmac | sed 's/://g;s/.*\(....\)$/\1/')
			HOSTNAME="${OS_NAME}-${MAC_SUFFIX}"
		fi
		starting
		hostname "$HOSTNAME" && ok || fail
		sed -i "/^127.0.1.1/s/\t.*$/\t$HOSTNAME/" /etc/hosts
		;;
	stop)
		true
		;;
	*)
		die 1 "Usage: $0 {start}"
		;;
esac

exit 0
